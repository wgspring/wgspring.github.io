
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="wgspring">
    <title>分类: g++ - wgspring</title>
    <meta name="author" content="wgspring">
    
        <meta name="keywords" content="wgspring,blog,">
    
    
        <link rel="icon" href="https://wgspring.github.io/assets/images/avator.png">
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <script type="application/ld+json">{}</script>
    <meta name="description" content="wgspring的个人博客">
<meta property="og:type" content="blog">
<meta property="og:title" content="wgspring">
<meta property="og:url" content="https://wgspring.github.io/categories/g/index.html">
<meta property="og:site_name" content="wgspring">
<meta property="og:description" content="wgspring的个人博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="wgspring">
<meta property="article:tag" content="wgspring">
<meta property="article:tag" content="blog">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://wgspring.github.io/assets/images/avator.png"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-daxxak7tklmhrut22lc1vikw50t0gpzpcbb35ufnnkxxgh8oq8bapzeahhji.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            wgspring
        </a>
    </div>
    
        
            <a
                class="header-right-icon open-algolia-search"
                href="#search"
                aria-label="打开链接: /#search"
            >
        
        
            <i class="fa fa-search fa-lg"></i>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="阅读有关作者的更多信息"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/avator.png" alt="作者的图片"/>
                </a>
                <h4 class="sidebar-profile-name">wgspring</h4>
                
                    <h5 class="sidebar-profile-bio"><p>宁可死别，绝不生离</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/"
                            title="首页"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首页</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="分类"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分类</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="标签"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">标签</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="归档"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">归档</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                            title="搜索"
                        >
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">搜索</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                            title="关于"
                        >
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">关于</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/wgspring" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:wgspring@mail.ustc.edu.cn" target="_blank" rel="noopener" title="邮箱">
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">邮箱</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/g/g++%E7%9A%84%E4%BD%BF%E7%94%A8/"
                            aria-label=": g++的使用"
                        >
                            g++的使用
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-01-04T10:20:38+08:00">
	
		    1月 04, 2020
    	
    </time>
    
        <span>发布在 </span>
        
    <a class="category-link" href="/categories/g/">g++</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p><ul class="markdownIt-TOC">
<li><a href="#1-%E7%94%9F%E6%88%90%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6">1. 生成可执行文件</a></li>
<li><a href="#2-%E7%94%9F%E6%88%90%E5%AF%B9%E8%B1%A1%E6%96%87%E4%BB%B6-o">2. 生成对象文件 – *.o</a>
<ul>
<li><a href="#21-%E5%AF%B9%E8%B1%A1%E6%96%87%E4%BB%B6%E5%88%B0%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6">2.1. 对象文件到可执行文件</a></li>
</ul>
</li>
<li><a href="#3-%E7%BC%96%E8%AF%91%E9%A2%84%E5%A4%84%E7%90%86">3. 编译预处理</a></li>
<li><a href="#4-%E7%94%9F%E6%88%90%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4">4. 生成汇编指令</a></li>
<li><a href="#5-%E7%94%9F%E6%88%90%E9%9D%99%E6%80%81%E5%BA%93">5. 生成静态库</a>
<ul>
<li><a href="#51-%E9%9D%99%E6%80%81%E5%BA%93%E5%88%B0%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6">5.1. 静态库到可执行文件</a></li>
</ul>
</li>
<li><a href="#6-%E7%94%9F%E6%88%90%E5%8A%A8%E6%80%81%E5%BA%93">6. 生成动态库</a>
<ul>
<li><a href="#61-%E5%8A%A8%E6%80%81%E5%BA%93%E5%88%B0%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6">6.1. 动态库到可执行文件</a></li>
<li><a href="#62-%E6%9F%A5%E7%9C%8B%E5%8F%AF%E6%89%A7%E8%A1%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E4%BA%86%E5%93%AA%E4%BA%9B%E5%BA%93">6.2. 查看可执行程序链接了哪些库</a></li>
</ul>
</li>
</ul>
</p>
<p>以下教程只适合<code>linux</code>系统</p>
<h2 id="1-生成可执行文件"><a class="markdownIt-Anchor" href="#1-生成可执行文件"></a> 1. 生成可执行文件</h2>
<p>当要求生成可执行文件时，要求代码里面一定要包含main函数，为程序入口。</p>
<ol>
<li>
<p>如果为单文件，例如<code>main.cpp</code>，执行：</p>
<ul>
<li><code>g++ main.cpp</code></li>
</ul>
<p>则会生成一个<code>a.out</code>文件，该文件即为可执行文件。终端执行<code>./a.out</code>即可</p>
</li>
<li>
<p>如果希望生成的文件名可以指定，则可以使用<code>-o</code>参数执行：</p>
<ul>
<li><code>g++ main.cpp -o main</code></li>
</ul>
<p>其中<code>main</code>即为你期望生成的文件名</p>
</li>
<li>
<p>如果为多个文件，可以使用<code>g++ *.cpp</code>来通配所有cpp文件</p>
</li>
</ol>
<h2 id="2-生成对象文件-o"><a class="markdownIt-Anchor" href="#2-生成对象文件-o"></a> 2. 生成对象文件 – *.o</h2>
<p>选项 -c 用来告诉编译器编译源代码但不要执行链接，输出结果为对象文件。文件默认名与源码文件名相同，只是将其后缀变为 .o。</p>
<p><code>g++ -c main.cpp</code></p>
<p>上述命令会生成<code>main.o</code></p>
<h3 id="21-对象文件到可执行文件"><a class="markdownIt-Anchor" href="#21-对象文件到可执行文件"></a> 2.1. 对象文件到可执行文件</h3>
<p>命令 g++ 能够直接识别 .o 文件并将其作为输入文件传递给链接器。</p>
<p><code>g++ main.o</code>或则<code>g++ main.o -o main</code></p>
<p>生成可执行文件<code>a.out</code>或则<code>main</code></p>
<h2 id="3-编译预处理"><a class="markdownIt-Anchor" href="#3-编译预处理"></a> 3. 编译预处理</h2>
<p>选项 -E 使 g++ 将源代码用编译预处理器处理后不再执行其他动作。</p>
<p><code>g++ -E main.cpp</code></p>
<p>上述命令不会生成文件，只会打印预处理的信息，如果要保存到文件可以附加使用<code>-o</code>选项</p>
<h2 id="4-生成汇编指令"><a class="markdownIt-Anchor" href="#4-生成汇编指令"></a> 4. 生成汇编指令</h2>
<p>选项 -S 指示编译器将程序编译成汇编语言，输出汇编语言代码而後结束。</p>
<p><code>g++ -S main.cpp</code></p>
<h2 id="5-生成静态库"><a class="markdownIt-Anchor" href="#5-生成静态库"></a> 5. 生成静态库</h2>
<p>静态库是编译器生成的一系列对象文件(<code>*.o文件</code>)的集合。链接一个程序时用库中的对象文件还是目录中的对象文件都是一样的。库中的成员包括普通函数，类定义，类的对象实例等等。静态库的另一个名字叫归档文件(archive)，管理这种归档文件的工具叫 ar 。</p>
<p><code>ar -r mylib.a object1.o object2.o</code></p>
<h3 id="51-静态库到可执行文件"><a class="markdownIt-Anchor" href="#51-静态库到可执行文件"></a> 5.1. 静态库到可执行文件</h3>
<p>命令 g++ 能够直接识别静态库 <code>.a</code> 文件并将其作为输入文件传递给链接器。</p>
<p><code>g++ mylib.a</code></p>
<h2 id="6-生成动态库"><a class="markdownIt-Anchor" href="#6-生成动态库"></a> 6. 生成动态库</h2>
<p><code>g++ one.cpp two.cpp three.cpp -fPIC -shared -o libtest.so</code></p>
<ul>
<li>
<p><code>-shared</code>：该选项指定生成动态连接库（让连接器生成T类型的导出符号表，有时候也生成弱连接W类型的导出符号），不用该标志外部程序无法连接。相当于一个可执行文件</p>
</li>
<li>
<p><code>-fPIC</code>：表示编译为位置独立的代码，不用此选项的话编译后的代码是位置相关的所以动态载入时是通过代码拷贝的方式来满足不同进程的需要，而不能达到真正代码段共享的目的。</p>
</li>
</ul>
<h3 id="61-动态库到可执行文件"><a class="markdownIt-Anchor" href="#61-动态库到可执行文件"></a> 6.1. 动态库到可执行文件</h3>
<p>例如讲<code>main.cpp</code>和动态库<code>libtest.so</code>一起链接</p>
<p><code>g++ main.cpp -L. -ltest -o main</code></p>
<ul>
<li><code>-L.</code>：表示要连接的库在当前目录中，<code>-L</code>指定动态库目录，<code>.</code>表示当前目录</li>
<li><code>-ltest</code>：编译器查找动态连接库时有隐含的命名规则，即在给出的名字前面加上lib，后面加上.so来确定库的名称。<code>-l</code>指定连接的动态库名称，<code>test</code>表示<code>libtest.so</code>这个文件。</li>
</ul>
<h3 id="62-查看可执行程序链接了哪些库"><a class="markdownIt-Anchor" href="#62-查看可执行程序链接了哪些库"></a> 6.2. 查看可执行程序链接了哪些库</h3>
<p><code>ldd main</code></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/g/g++%E7%9A%84%E4%BD%BF%E7%94%A8/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                评论和共享
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">第 1 页 共 1 页</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 wgspring. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avator.png" alt="作者的图片"/>
        
            <h4 id="about-card-name">wgspring</h4>
        
            <div id="about-card-bio"><p>宁可死别，绝不生离</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>搬砖的</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                China
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover-v1.2.0.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-sz3sxionvszurexlutkltvtcs6eo6soswf2uxgpgtd3dk9dmc1rbsivd5qvg.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
